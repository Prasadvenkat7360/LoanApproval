var alasql=window.alasql;function getColumnHeaders(e){console.log(e);var t=[];if(e.length>0){var n=e[0];$.each(n,function(e,n){t.push(e)})}return t}function convertToHierarchy(e,t,n){var l=[],c=!1,o="";if(e.length>0&&t.length>0)return $.map(e,function(e){if(Object.keys(e)[0]==t[0])l.push(e),c=!1,o="";else{if(o!=Object.keys(e)[n]&&(o=Object.keys(e)[n],c=!1),!c){var a=0,r=!0,u={},i=Object.keys(e).length;$.each(t,function(t,n){!r&&a<i?(u[n]=Object.keys(e)[a],a++):(u[n]="",r=!1)}),l.push(u),c=!0}a=0,r=!0,u={},i=Object.keys(e).length;$.each(t,function(t,n){if(!r&&a<i){var l=Object.keys(e)[a],c=e[l];u[n]=c,a++}else u[n]="",r=!1}),l.push(u)}}),l}function convertToExport(e,t){return convertToHierarchy(e,getColumnHeaders(e),t)}function removeDuplicates(e,t,n,l){var c,o="";e.length>0&&("undefined"==$.type(l)&&(l=""),$.map(e,function(e){var l=Object.keys(e).length;t>-1&&t<l&&n>-1&&n<l&&(c=Object.keys(e)[t],e[c]==o?e[c=Object.keys(e)[n]]="":(c=Object.keys(e)[t],o=e[c]))}));return e}function removeNullData(e){return e.length>0&&$.map(e,function(e){Object.keys(e).length>0&&$.each(e,function(t){var n=e[t];null!=n&&"null"!=n&&"Null"!=n||(e[t]="")})}),e}function getObjectKeys(e){var t=[];if(null!=e){var n=e;$.each(n,function(e,n){t.push(e)})}return t}function adjustObjectKeys(e){if(e.length>0){var t=null,n=0;$.map(e,function(e){Object.keys(e).length>n&&(t=e,n=Object.keys(e).length)});var l=getObjectKeys(t);l.length>0&&$.map(e,function(e){var t=getObjectKeys(e);$.each(l,function(n,l){t.indexOf(l)<0&&(e[l]="")})}),console.log(e)}return e}var fileEvent=null,uploadFileColumns='[{"StoreName","Zone","Stock_Cust","Sl_No","Wt_Range","Size","GR_Date","Days_At_Comp","Metal_Seg","Art_Seg","Jwl_Code","Sub_Catg","Art_Code","Vnd_Code","PCS","Gross_Wt","Net_Wt","Item_Cost","Item_SP","Entered_By","Sl","StnCode","StnSubCat","StnPcs","StnWt","StnCost","AccCode","AccSubCat","AccPcs","AccWt","AccCost"}]';function readExcelFile(e){var t='select * from xlsx("'+e+'",{headers:true})';alasql.promise(t).then(function(e){console.log("Uploaded Data: ",e)}).catch(function(e){console.log("Upload Error: ",e)})}function uploadExcelFile(){null==fileEvent||null!=fileEvent&&"object"!=$.type(fileEvent)?alert("Please select the data Excel file to load!"):(loadExcelDataFile(fileEvent),fileEvent=null)}function loadExcelDataFile(e){alasql("SELECT * FROM FILE(?,{headers:true})",[e],function(e){console.log(JSON.stringify(e)),alert(JSON.stringify(e))}).catch(function(e){console.log("Upload Error: ",e),alert("Upload Error: ",e)})}function captureFileSelectEvent(e){fileEvent=e}